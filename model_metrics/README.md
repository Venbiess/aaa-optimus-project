# Модель и её оценка

## 1. Выбор подхода:
- Был проведен анализ методов пиксельной сегментации объектов, 
- Рассмотрены различные подходы, включая:
  - Использование связки моделей: YOLO (быстрый zero-shot детектор для локализации объекта с bounding box) + SAM (zero-shot сегментатор, выполняющий точную сегментацию по подсказке от YOLO)
  - Архитектуры CNN, напрямую выдающие маску сегментации.
- на основании которого была выбрана архитектура сверточных нейронных сетей - Unet, поскольку данная модель хорошо зарекомендовала себя, а также оставлена возможность реализации YOLO + SAM
  
## 2. Настройка валидации:
- Для оценки качества модели Unet использовалось разделение на тестовую (20%) и тренировочную выборки (80%). Утечки целевой переменной не было, поскольку признаки не содержат информации о целевой маске для этого же изображения

## 3. Создание бейзлайна:
- Для пиксельной сегментации простые эвристики по типу выделение центральной области дают сильно хуже качество по сравнению с нейросетями. Поэтому в данном случае бейзлайн - это визуально неудовлитворительный результат, получаемый без использования специализированной нейронной сети

## 4. Обучение модели
- была использована архитектура Unet с энкодером Resnet18, предобученным на ImageNet для лучшего извлечения признаков.
- В качестве функции потерь была использована Dice Loss + BCE Loss, подходящая для бинарной классификации
- Обучение происходило в течение 50 эпох, по ходу обучения сохранялась лучшая модель по версии метрики IoU

## 5. Анализ ошибок модели
- Был проведен визуальный анализ предсказанных масок. Типичными ошибками модели оказались тонкие выступающие части (антенны) и сливающиеся с фонов части автомобилей. 
Отлично, давайте интегрируем информацию о SAM и YOLO в структуру вашей методологии. Это покажет, что вы рассмотрели различные подходы к сегментации.
- Метрики Unet:
  - IoU (Intersection Over Union): 0.9577
  - Dice Score (F-score): 0.978
- Метрики YOLO + SAM:
  - IoU (Intersection Over Union): 0.95
  - Accuracy: 0.981

Ноутбуки с анализом данных, обучением модели и расчетом метрик находятся [здесь](https://github.com/Venbiess/aaa-optimus-project/tree/main/project/notebooks)
