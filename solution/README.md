# Решение и метрики
## Бизнес Метрики и функции потерь (метрики машинного обучения для обучения модели)
### Метрики качества сегментации
`Dice Score`
$$
d=\dfrac{2\cdot|X\cap Y|}{|X|+|Y|}
$$

`mAP`
$$
mAP=\dfrac{1}{n}\sum\limits^{n}_{k=1}AP_k
$$

`IoU (Intersection Over Union)`
$$
\text{IoU}=\dfrac{|X\cap Y|}{|X\cup Y|}
$$

Все метрики выше подходят для задачи бинарной сегментации и отражют попиксельное сходство масок полученной сегментации с исходной. Принимаемые значения от 0 до 1, чем больше тем лучше.

### Функции потерь для задачи сегментации
`BCEWithLogitsLoss` - функция потерь, используемая для задачи попиксельной бинарной классификации для определения принадлежности пикселя к маске.

### Метрики качества замены фона
В качестве оценку качества замены фона можно попробовать использовать модели, специально обученные на определение сгенерированности изображения. Подробнее про них описано [здесь](https://uk.mathworks.com/help/images/image-quality-metrics.html).

Примеры таких моделей:

`BRISQUE` - модель, обученна на выявление различных искажений. Принимаемые значения скора модели $[0,\ 100]$, где более низкие значения отражают лучшее качество восприятия картинки. Однако данная модель, судя по описанию больше нацелена на выявление добавления шума, размытия и прочих искажений изображения, не связанные с заменой фона.

`NIQE` - модель, обученная на "нетронутых" изображениях, выдаёт неотрицательный скор. Чем ближе к нулю, тем больше модель уверена в том, что изображение не было сгенерировано.


### Метрики качества генерации изображения
`Frechet Inception Distance (FID)`
$$
d^2 = ||\mu_1-\mu_2||^2+\text{Tr}(C_1+C_2-2\sqrt{C_1\cdot C_2})
$$
Метрика сравнивает схожесть распределений, по вектору мат. ожиданий и ковариационной матрице исходного распределения и получившегося.

Метрика может принимать любые неотрицательные значения ($d^2\in[0;\ +\infty)$), чем меньше значение, тем лучше.